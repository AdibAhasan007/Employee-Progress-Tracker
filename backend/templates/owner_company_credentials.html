{% extends "base.html" %}
{% load static %}

{% block title %}Company Admin Credentials - {{ company.name }}{% endblock %}

{% block content %}
<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Success Banner -->
            <div class="alert alert-success alert-dismissible fade show" role="alert" style="border-left: 5px solid #667eea;">
                <i class="fas fa-check-circle me-2"></i>
                <strong>Company Created Successfully!</strong>
                <p class="mb-0 mt-2">{{ company.name }} has been created and is ready to use. Share the admin credentials below with your company administrator.</p>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Company Info Card -->
            <div class="card mb-4" style="border-top: 4px solid #667eea;">
                <div class="card-header bg-white py-3">
                    <h4 class="mb-0"><i class="fas fa-building me-2" style="color: #667eea;"></i>Company Information</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Company Name:</strong><br>{{ company.name }}</p>
                            <p><strong>Company Email:</strong><br>{{ company.email|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Status:</strong><br><span class="badge bg-info">{{ company.get_status_display }}</span></p>
                            <p><strong>Trial Period:</strong><br>30 days</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Credentials Card -->
            <div class="card mb-4" style="border-top: 4px solid #764ba2;">
                <div class="card-header bg-white py-3">
                    <h4 class="mb-0"><i class="fas fa-user-shield me-2" style="color: #764ba2;"></i>Admin Account Credentials</h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning" style="background-color: #fff3cd; border-left: 4px solid #ff9800;">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Important:</strong> Save these credentials securely. They are needed to login to the admin dashboard.
                    </div>

                    <!-- Username -->
                    <div class="form-group mb-4">
                        <label class="form-label"><strong>Admin Username</strong></label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="admin-username" value="{{ admin_username }}" readonly style="background-color: #f8f9fa;">
                            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('admin-username')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="form-group mb-4">
                        <label class="form-label"><strong>Admin Email</strong></label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="admin-email" value="{{ admin_email }}" readonly style="background-color: #f8f9fa;">
                            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('admin-email')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                    </div>

                    <!-- Password -->
                    <div class="form-group mb-4">
                        <label class="form-label"><strong>Admin Password (Temporary)</strong></label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="admin-password" value="{{ admin_password }}" readonly style="background-color: #f8f9fa;">
                            <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility()">
                                <i class="fas fa-eye" id="toggle-eye"></i>
                            </button>
                            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('admin-password')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                        <small class="text-muted d-block mt-2">
                            <i class="fas fa-info-circle"></i> The admin should change this password on first login.
                        </small>
                    </div>
                </div>
            </div>

            <!-- Login Information Card -->
            <div class="card mb-4" style="border-top: 4px solid #17a2b8;">
                <div class="card-header bg-white py-3">
                    <h4 class="mb-0"><i class="fas fa-sign-in-alt me-2" style="color: #17a2b8;"></i>How to Login</h4>
                </div>
                <div class="card-body">
                    <ol class="mb-0">
                        <li class="mb-3">
                            Open the admin login page:<br>
                            <code style="background-color: #f8f9fa; padding: 5px 10px; border-radius: 3px;">
                                {{ request.scheme }}://{{ request.get_host }}/login/
                            </code>
                        </li>
                        <li class="mb-3">
                            Enter the admin credentials:
                            <ul>
                                <li><strong>Username:</strong> {{ admin_username }}</li>
                                <li><strong>Password:</strong> (from above)</li>
                            </ul>
                        </li>
                        <li class="mb-3">
                            Click <strong>Sign In</strong> to access the admin dashboard
                        </li>
                        <li>
                            From the dashboard, the admin can:
                            <ul>
                                <li>Create employee accounts</li>
                                <li>Manage company settings</li>
                                <li>View productivity reports</li>
                                <li>Configure company policies</li>
                            </ul>
                        </li>
                    </ol>
                </div>
            </div>

            <!-- Next Steps Card -->
            <div class="card mb-4" style="border-top: 4px solid #28a745;">
                <div class="card-header bg-white py-3">
                    <h4 class="mb-0"><i class="fas fa-tasks me-2" style="color: #28a745;"></i>Next Steps</h4>
                </div>
                <div class="card-body">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-marker" style="background-color: #667eea; color: white;">1</div>
                            <div class="timeline-content">
                                <strong>Share Credentials</strong><br>
                                <small class="text-muted">Send the admin username and password to your company administrator securely</small>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker" style="background-color: #667eea; color: white;">2</div>
                            <div class="timeline-content">
                                <strong>Admin Login</strong><br>
                                <small class="text-muted">Admin logs in at the login page using the provided credentials</small>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker" style="background-color: #667eea; color: white;">3</div>
                            <div class="timeline-content">
                                <strong>Create Employees</strong><br>
                                <small class="text-muted">Admin creates employee accounts in the company dashboard</small>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker" style="background-color: #667eea; color: white;">4</div>
                            <div class="timeline-content">
                                <strong>Setup Complete</strong><br>
                                <small class="text-muted">Employees can now login and use the desktop monitoring software</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex gap-2 mb-4">
                <a href="{% url 'owner-dashboard' %}" class="btn btn-primary" style="background: linear-gradient(90deg, #667eea, #764ba2); border: none;">
                    <i class="fas fa-arrow-left me-2"></i> Back to Dashboard
                </a>
                <button class="btn btn-success" onclick="printCredentials()">
                    <i class="fas fa-print me-2"></i> Print Credentials
                </button>
            </div>
        </div>
    </div>
</div>

<style>
.timeline {
    position: relative;
    padding: 20px 0;
}

.timeline-item {
    display: flex;
    margin-bottom: 30px;
    align-items: flex-start;
}

.timeline-item:last-child {
    margin-bottom: 0;
}

.timeline-marker {
    min-width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 20px;
    font-weight: bold;
    flex-shrink: 0;
}

.timeline-content {
    padding-top: 5px;
}

.timeline-content strong {
    color: #333;
    font-size: 1rem;
    display: block;
    margin-bottom: 5px;
}

@media print {
    .alert-success,
    .d-flex,
    .btn {
        display: none !important;
    }
    
    .card {
        page-break-inside: avoid;
    }
}
</style>

<script>
function copyToClipboard(elementId) {
    const element = document.getElementById(elementId);
    element.select();
    document.execCommand('copy');
    
    // Show feedback
    const btn = event.target.closest('button');
    const originalHTML = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
    btn.classList.add('btn-success');
    btn.classList.remove('btn-outline-secondary');
    
    setTimeout(() => {
        btn.innerHTML = originalHTML;
        btn.classList.remove('btn-success');
        btn.classList.add('btn-outline-secondary');
    }, 2000);
}

function togglePasswordVisibility() {
    const passwordInput = document.getElementById('admin-password');
    const toggleEye = document.getElementById('toggle-eye');
    
    if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleEye.classList.remove('fa-eye');
        toggleEye.classList.add('fa-eye-slash');
    } else {
        passwordInput.type = 'password';
        toggleEye.classList.remove('fa-eye-slash');
        toggleEye.classList.add('fa-eye');
    }
}

function printCredentials() {
    const printWindow = window.open('', '', 'width=600,height=700');
    const content = document.querySelector('.container').innerHTML;
    
    printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Admin Credentials - {{ company.name }}</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
            <style>
                body { padding: 20px; }
                .credentials-box { 
                    border: 2px solid #667eea; 
                    padding: 20px; 
                    border-radius: 8px;
                    margin: 20px 0;
                    background-color: #f8f9fa;
                }
                .credential-item {
                    margin: 15px 0;
                }
                .credential-label {
                    font-weight: bold;
                    color: #333;
                }
                .credential-value {
                    font-family: monospace;
                    background-color: white;
                    padding: 8px;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                }
            </style>
        </head>
        <body>
            <h2>Admin Credentials - {{ company.name }}</h2>
            <p style="color: #666;">Created: ${new Date().toLocaleString()}</p>
            
            <div class="credentials-box">
                <div class="credential-item">
                    <div class="credential-label">Username:</div>
                    <div class="credential-value">{{ admin_username }}</div>
                </div>
                <div class="credential-item">
                    <div class="credential-label">Email:</div>
                    <div class="credential-value">{{ admin_email }}</div>
                </div>
                <div class="credential-item">
                    <div class="credential-label">Password:</div>
                    <div class="credential-value">{{ admin_password }}</div>
                </div>
            </div>
            
            <h4>Login Instructions</h4>
            <ol>
                <li>Go to: {{ request.scheme }}://{{ request.get_host }}/login/</li>
                <li>Enter the credentials above</li>
                <li>Click Sign In</li>
                <li>Create employee accounts to enable team members to use the software</li>
            </ol>
            
            <p style="color: #999; font-size: 0.9rem; margin-top: 40px;">
                Keep these credentials secure. The admin should change the password on first login.
            </p>
        </body>
        </html>
    `);
    
    printWindow.document.close();
    printWindow.print();
}
</script>
{% endblock %}
