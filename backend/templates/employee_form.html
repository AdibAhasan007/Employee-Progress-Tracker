{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="h3 text-gray-800">{% if is_edit %}Edit Employee{% else %}Add New Employee{% endif %}</h2>
        <a href="{% url 'employee-list' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i> Back to List
        </a>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow mb-4">
                <div class="card-header py-3 bg-white">
                    <h6 class="m-0 font-weight-bold text-primary">Employee Details</h6>
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">First Name</label>
                                <input type="text" name="first_name" class="form-control" value="{% if employee %}{{ employee.first_name }}{% endif %}" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Last Name</label>
                                <input type="text" name="last_name" class="form-control" value="{% if employee %}{{ employee.last_name }}{% endif %}" required>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Email Address (Username)</label>
                            <input type="email" name="email" class="form-control" value="{% if employee %}{{ employee.email }}{% endif %}" required>
                            <div class="form-text">{% if is_edit %}Changing email will update the username.{% else %}This will be used as the login username.{% endif %}</div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Password</label>
                            <input type="password" name="password" class="form-control" {% if not is_edit %}required{% endif %}>
                            <div class="form-text">{% if is_edit %}Leave blank to keep current password.{% endif %}</div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Role</label>
                                <select name="role" class="form-select">
                                    <option value="EMPLOYEE" {% if employee.role == 'EMPLOYEE' %}selected{% endif %}>Employee</option>
                                </select>
                                <div class="form-text">Employees have limited access. For Admin/Manager, use Staff Management.</div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Designation</label>
                                <input type="text" name="designation" class="form-control" value="{% if employee %}{{ employee.designation }}{% endif %}" placeholder="e.g., Software Developer, Designer">
                                <div class="form-text">Job title (optional)</div>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Timezone</label>
                                <select name="timezone" class="form-select">
                                    <optgroup label="Asia">
                                        <option value="Asia/Kabul" {% if not employee or employee.timezone == 'Asia/Kabul' %}selected{% endif %}>Afghanistan (GMT+4:30)</option>
                                        <option value="Asia/Dhaka" {% if employee.timezone == 'Asia/Dhaka' %}selected{% endif %}>Bangladesh (GMT+6) ‚≠ê</option>
                                        <option value="Asia/Brunei" {% if employee.timezone == 'Asia/Brunei' %}selected{% endif %}>Brunei (GMT+8)</option>
                                        <option value="Asia/Yangon" {% if employee.timezone == 'Asia/Yangon' %}selected{% endif %}>Myanmar (GMT+6:30)</option>
                                        <option value="Asia/Shanghai" {% if employee.timezone == 'Asia/Shanghai' %}selected{% endif %}>China (GMT+8)</option>
                                        <option value="Asia/Hong_Kong" {% if employee.timezone == 'Asia/Hong_Kong' %}selected{% endif %}>Hong Kong (GMT+8)</option>
                                        <option value="Asia/Kolkata" {% if employee.timezone == 'Asia/Kolkata' %}selected{% endif %}>India (GMT+5:30)</option>
                                        <option value="Asia/Jakarta" {% if employee.timezone == 'Asia/Jakarta' %}selected{% endif %}>Indonesia - Jakarta (GMT+7)</option>
                                        <option value="Asia/Makassar" {% if employee.timezone == 'Asia/Makassar' %}selected{% endif %}>Indonesia - Makassar (GMT+8)</option>
                                        <option value="Asia/Jayapura" {% if employee.timezone == 'Asia/Jayapura' %}selected{% endif %}>Indonesia - Jayapura (GMT+9)</option>
                                        <option value="Asia/Tehran" {% if employee.timezone == 'Asia/Tehran' %}selected{% endif %}>Iran (GMT+3:30)</option>
                                        <option value="Asia/Baghdad" {% if employee.timezone == 'Asia/Baghdad' %}selected{% endif %}>Iraq (GMT+3)</option>
                                        <option value="Asia/Tokyo" {% if employee.timezone == 'Asia/Tokyo' %}selected{% endif %}>Japan (GMT+9)</option>
                                        <option value="Asia/Amman" {% if employee.timezone == 'Asia/Amman' %}selected{% endif %}>Jordan (GMT+3)</option>
                                        <option value="Asia/Almaty" {% if employee.timezone == 'Asia/Almaty' %}selected{% endif %}>Kazakhstan (GMT+6)</option>
                                        <option value="Asia/Kuwait" {% if employee.timezone == 'Asia/Kuwait' %}selected{% endif %}>Kuwait (GMT+3)</option>
                                        <option value="Asia/Beirut" {% if employee.timezone == 'Asia/Beirut' %}selected{% endif %}>Lebanon (GMT+2/3)</option>
                                        <option value="Asia/Kuala_Lumpur" {% if employee.timezone == 'Asia/Kuala_Lumpur' %}selected{% endif %}>Malaysia (GMT+8)</option>
                                        <option value="Asia/Kathmandu" {% if employee.timezone == 'Asia/Kathmandu' %}selected{% endif %}>Nepal (GMT+5:45)</option>
                                        <option value="Asia/Karachi" {% if employee.timezone == 'Asia/Karachi' %}selected{% endif %}>Pakistan (GMT+5)</option>
                                        <option value="Asia/Manila" {% if employee.timezone == 'Asia/Manila' %}selected{% endif %}>Philippines (GMT+8)</option>
                                        <option value="Asia/Qatar" {% if employee.timezone == 'Asia/Qatar' %}selected{% endif %}>Qatar (GMT+3)</option>
                                        <option value="Asia/Riyadh" {% if employee.timezone == 'Asia/Riyadh' %}selected{% endif %}>Saudi Arabia (GMT+3)</option>
                                        <option value="Asia/Singapore" {% if employee.timezone == 'Asia/Singapore' %}selected{% endif %}>Singapore (GMT+8)</option>
                                        <option value="Asia/Seoul" {% if employee.timezone == 'Asia/Seoul' %}selected{% endif %}>South Korea (GMT+9)</option>
                                        <option value="Asia/Colombo" {% if employee.timezone == 'Asia/Colombo' %}selected{% endif %}>Sri Lanka (GMT+5:30)</option>
                                        <option value="Asia/Damascus" {% if employee.timezone == 'Asia/Damascus' %}selected{% endif %}>Syria (GMT+2/3)</option>
                                        <option value="Asia/Taipei" {% if employee.timezone == 'Asia/Taipei' %}selected{% endif %}>Taiwan (GMT+8)</option>
                                        <option value="Asia/Bangkok" {% if employee.timezone == 'Asia/Bangkok' %}selected{% endif %}>Thailand (GMT+7)</option>
                                        <option value="Asia/Dubai" {% if employee.timezone == 'Asia/Dubai' %}selected{% endif %}>UAE (GMT+4)</option>
                                        <option value="Asia/Samarkand" {% if employee.timezone == 'Asia/Samarkand' %}selected{% endif %}>Uzbekistan (GMT+5)</option>
                                        <option value="Asia/Ho_Chi_Minh" {% if employee.timezone == 'Asia/Ho_Chi_Minh' %}selected{% endif %}>Vietnam (GMT+7)</option>
                                    </optgroup>
                                    <optgroup label="Europe">
                                        <option value="Europe/London" {% if employee.timezone == 'Europe/London' %}selected{% endif %}>UK (GMT+0/+1)</option>
                                        <option value="Europe/Paris" {% if employee.timezone == 'Europe/Paris' %}selected{% endif %}>France (GMT+1/+2)</option>
                                        <option value="Europe/Berlin" {% if employee.timezone == 'Europe/Berlin' %}selected{% endif %}>Germany (GMT+1/+2)</option>
                                        <option value="Europe/Rome" {% if employee.timezone == 'Europe/Rome' %}selected{% endif %}>Italy (GMT+1/+2)</option>
                                        <option value="Europe/Madrid" {% if employee.timezone == 'Europe/Madrid' %}selected{% endif %}>Spain (GMT+1/+2)</option>
                                        <option value="Europe/Amsterdam" {% if employee.timezone == 'Europe/Amsterdam' %}selected{% endif %}>Netherlands (GMT+1/+2)</option>
                                        <option value="Europe/Brussels" {% if employee.timezone == 'Europe/Brussels' %}selected{% endif %}>Belgium (GMT+1/+2)</option>
                                        <option value="Europe/Vienna" {% if employee.timezone == 'Europe/Vienna' %}selected{% endif %}>Austria (GMT+1/+2)</option>
                                        <option value="Europe/Warsaw" {% if employee.timezone == 'Europe/Warsaw' %}selected{% endif %}>Poland (GMT+1/+2)</option>
                                        <option value="Europe/Moscow" {% if employee.timezone == 'Europe/Moscow' %}selected{% endif %}>Russia - Moscow (GMT+3)</option>
                                        <option value="Europe/Istanbul" {% if employee.timezone == 'Europe/Istanbul' %}selected{% endif %}>Turkey (GMT+3)</option>
                                        <option value="Europe/Athens" {% if employee.timezone == 'Europe/Athens' %}selected{% endif %}>Greece (GMT+2/+3)</option>
                                        <option value="Europe/Zurich" {% if employee.timezone == 'Europe/Zurich' %}selected{% endif %}>Switzerland (GMT+1/+2)</option>
                                        <option value="Europe/Stockholm" {% if employee.timezone == 'Europe/Stockholm' %}selected{% endif %}>Sweden (GMT+1/+2)</option>
                                        <option value="Europe/Oslo" {% if employee.timezone == 'Europe/Oslo' %}selected{% endif %}>Norway (GMT+1/+2)</option>
                                        <option value="Europe/Helsinki" {% if employee.timezone == 'Europe/Helsinki' %}selected{% endif %}>Finland (GMT+2/+3)</option>
                                    </optgroup>
                                    <optgroup label="Americas">
                                        <option value="America/New_York" {% if employee.timezone == 'America/New_York' %}selected{% endif %}>USA - New York (GMT-5/-4)</option>
                                        <option value="America/Chicago" {% if employee.timezone == 'America/Chicago' %}selected{% endif %}>USA - Chicago (GMT-6/-5)</option>
                                        <option value="America/Denver" {% if employee.timezone == 'America/Denver' %}selected{% endif %}>USA - Denver (GMT-7/-6)</option>
                                        <option value="America/Los_Angeles" {% if employee.timezone == 'America/Los_Angeles' %}selected{% endif %}>USA - Los Angeles (GMT-8/-7)</option>
                                        <option value="America/Toronto" {% if employee.timezone == 'America/Toronto' %}selected{% endif %}>Canada - Toronto (GMT-5/-4)</option>
                                        <option value="America/Vancouver" {% if employee.timezone == 'America/Vancouver' %}selected{% endif %}>Canada - Vancouver (GMT-8/-7)</option>
                                        <option value="America/Mexico_City" {% if employee.timezone == 'America/Mexico_City' %}selected{% endif %}>Mexico (GMT-6/-5)</option>
                                        <option value="America/Sao_Paulo" {% if employee.timezone == 'America/Sao_Paulo' %}selected{% endif %}>Brazil (GMT-3/-2)</option>
                                        <option value="America/Buenos_Aires" {% if employee.timezone == 'America/Buenos_Aires' %}selected{% endif %}>Argentina (GMT-3)</option>
                                        <option value="America/Santiago" {% if employee.timezone == 'America/Santiago' %}selected{% endif %}>Chile (GMT-3/-4)</option>
                                        <option value="America/Bogota" {% if employee.timezone == 'America/Bogota' %}selected{% endif %}>Colombia (GMT-5)</option>
                                    </optgroup>
                                    <optgroup label="Africa">
                                        <option value="Africa/Cairo" {% if employee.timezone == 'Africa/Cairo' %}selected{% endif %}>Egypt (GMT+2)</option>
                                        <option value="Africa/Lagos" {% if employee.timezone == 'Africa/Lagos' %}selected{% endif %}>Nigeria (GMT+1)</option>
                                        <option value="Africa/Johannesburg" {% if employee.timezone == 'Africa/Johannesburg' %}selected{% endif %}>South Africa (GMT+2)</option>
                                        <option value="Africa/Nairobi" {% if employee.timezone == 'Africa/Nairobi' %}selected{% endif %}>Kenya (GMT+3)</option>
                                        <option value="Africa/Casablanca" {% if employee.timezone == 'Africa/Casablanca' %}selected{% endif %}>Morocco (GMT+0/+1)</option>
                                    </optgroup>
                                    <optgroup label="Oceania">
                                        <option value="Australia/Sydney" {% if employee.timezone == 'Australia/Sydney' %}selected{% endif %}>Australia - Sydney (GMT+10/+11)</option>
                                        <option value="Australia/Melbourne" {% if employee.timezone == 'Australia/Melbourne' %}selected{% endif %}>Australia - Melbourne (GMT+10/+11)</option>
                                        <option value="Australia/Perth" {% if employee.timezone == 'Australia/Perth' %}selected{% endif %}>Australia - Perth (GMT+8)</option>
                                        <option value="Pacific/Auckland" {% if employee.timezone == 'Pacific/Auckland' %}selected{% endif %}>New Zealand (GMT+12/+13)</option>
                                    </optgroup>
                                    <optgroup label="Other">
                                        <option value="UTC" {% if employee.timezone == 'UTC' %}selected{% endif %}>UTC (GMT+0) - Universal</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Profile Picture</label>
                            {% if employee.profile_picture %}
                                <div class="mb-2">
                                    <img src="{{ employee.profile_picture.url }}" class="rounded" width="80" height="80">
                                    <small class="text-muted ms-2">Current picture</small>
                                </div>
                            {% endif %}
                            <input type="file" name="profile_picture" class="form-control">
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" name="is_active_employee" class="form-check-input" id="activeCheck" {% if not employee or employee.is_active_employee %}checked{% endif %}>
                            <label class="form-check-label" for="activeCheck">Active Employee</label>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button type="submit" class="btn btn-primary px-4">{% if is_edit %}Update Employee{% else %}Create Employee{% endif %}</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}